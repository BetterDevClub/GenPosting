@using GenPosting.Web.Services
@inject ILinkedInStateService LinkedInState
@inject IInstagramStateService InstagramState

@if (_initialized)
{
    <Router AppAssembly="@typeof(App).Assembly" NotFoundPage="typeof(Pages.NotFound)">
        <Found Context="routeData">
            <RouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)"/>
            <FocusOnNavigate RouteData="@routeData" Selector="h1" />
        </Found>
    </Router>
}
else
{
    <div style="height: 100vh; display: flex; align-items: center; justify-content: center;">
         <div style="display:flex; flex-direction:column; align-items:center;">
            <div class="mud-progress-circular mud-primary mud-progress-circular-indeterminate mud-progress-circular-medium" role="progressbar" aria-valuenow="0">
                <svg class="mud-progress-circular-svg" viewBox="22 22 44 44">
                    <circle class="mud-progress-circular-circle mud-progress-circular-circle-indeterminate" cx="44" cy="44" r="20" fill="none" stroke-width="3"></circle>
                </svg>
            </div>
            <span style="margin-top: 1rem; font-family: sans-serif; color: #555;">Loading GenPosting...</span>
         </div>
    </div>
}

@code {
    private bool _initialized = false;

    protected override async Task OnInitializedAsync()
    {
        await LinkedInState.InitializeAsync();
        await InstagramState.InitializeAsync();
        _initialized = true;
    }
}
